<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <title>Material Design for Bootstrap</title>
  <!-- MDB icon -->
  <link rel="icon" href="img/mdb-favicon.ico" type="image/x-icon" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" />
  <!-- Google Fonts Roboto -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" />
  <!-- MDB -->
  <link rel="stylesheet" href="css/bootstrap-to-do-list.min.css" />
</head>

<body>
  <!-- Start your project here-->
  <style>
    #list1 .form-control {
      border-color: transparent;
    }

    #list1 .form-control:focus {
      border-color: transparent;
      box-shadow: none;
    }

    #list1 .select-input.form-control[readonly]:not([disabled]) {
      background-color: #fbfbfb;
    }
  </style>
  <section class="vh-100">
    <div class="container py-5 h-100" id="to-do-list">
      <div class="row d-flex justify-content-center align-items-center h-100">
        <div class="col">
          <div class="card" id="list1" style="border-radius: .75rem; background-color: #eff1f2;">
            <div class="card-body py-4 px-4 px-md-5">

              <p class="h1 text-center mt-3 mb-4 pb-3 text-primary">
                <i class="fas fa-check-square me-1"></i>
                <u>My Todo-s </u>
              </p>
              <div class="pb-2">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex flex-row align-items-center">
                      <input class="form-control form-control-lg" id="exampleFormControlInput1" placeholder="Add new..."
                        v-model="text" v-on:input="inputTask">
                      <a href="#!" data-mdb-toggle="tooltip" title="Set due date"><i
                          class="fas fa-calendar-alt fa-lg me-3"></i></a>
                      <div>
                        <button type="button" class="btn btn-primary" :disabled="!text" @click="add" id="add-more-tasks"
                          v-on:click="buttonClick">Add</button>

                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <hr class="my-4">

              <div class="d-flex justify-content-end align-items-center mb-4 pt-2 pb-3">
                <p class="small mb-0 me-2 text-muted">Filter</p>
                <select class="select" v-model="selectedFilter">
                  <option value="1">All</option>
                  <option value="2">Completed</option>
                  <option value="3">Active</option>
                  <option value="4">Has due date</option>
                </select>

                <p class="small mb-0 ms-4 me-2 text-muted">Sort</p>
                <select class="select">
                  <option value="1">Added date</option>
                  <option value="2">Due date</option>
                </select>
                <a href="#!" style="color: #23af89;" data-mdb-toggle="tooltip" title="Ascending"><i
                    class="fas fa-sort-amount-down-alt ms-2"></i></a>
              </div>
              <div v-for="key in count" :key="key">
                <ul class="list-group list-group-horizontal rounded-0 bg-transparent" v-bind:title="tasks[task.id]"
                  size="50" :id="task.id" :class="{'bg-green': isChecked[index]}">
                  <li
                    class="list-group-item d-flex align-items-center ps-0 pe-3 py-1 rounded-0 border-0 bg-transparent">
                    <div class="form-check" :class="{'bg-green': isChecked[key]}">
                      <input class="form-check-input me-0" :class="{'bg-green': isChecked[key]}" name="agreement"
                        type="checkbox" :id="`todo${key}`" aria-label="..." v-model="isChecked[key]"
                        @change="completeTask(key)" />
                    </div>
                  </li>
                  <li class="list-group-item px-3 py-1 d-flex align-items-center flex-grow-1 border-0 bg-transparent"
                    v-model="task['dynamic-field-'+key]">
                    <p class="lead fw-normal mb-0" v-if="!isEditing">{{taskTxt}}</p>
                    <div v-else class="d-flex flex-row justify-content-end mb-1">
                      <input class="form-control form-control-lg" :id="`newValue-${task.id}`"
                        placeholder="{{task.taskTxt}}" v-model="editText[index]" v-on:input="editTask(key)" />
                      <button type="button" class="btn btn-primary" @click="saveEditedTaskText(index)"
                        id="save-edited-task">Save</button>
                    </div>
                  </li>
                  <li class="list-group-item ps-3 pe-0 py-1 rounded-0 border-0 bg-transparent">
                    <div class="d-flex flex-row justify-content-end mb-1">
                      <a href="#!" class="text-info" data-mdb-toggle="tooltip" id="edit-task${key}" @click="edit(key)"
                        title="Edit todo"><i class="fas fa-pencil-alt me-3"></i></a>
                      <a href="#!" class="text-danger" data-mdb-toggle="tooltip" id="delete-task" @click="remove"
                        title="Delete todo"><i class="fas fa-trash-alt"></i></a>
                    </div>
                    <div class="text-end text-muted">
                      <a href="#!" class="text-muted" data-mdb-toggle="tooltip" title="Created date">
                        <p class="small mb-0"><i class="fas fa-info-circle me-2"></i>{{dateOfAddedTask}}</p>
                      </a>
                    </div>
                  </li>
                </ul>

              </div>
            </div>
          </div>
        </div>

        <button type="button" class="btn btn-primary" @click="showCompleted = !showCompleted"
          @click="showCompletedTasks">
          {{ showCompleted ? 'Hide completed tasks' : 'Show completed tasks' }}
        </button>

        <ul v-if="showCompleted">
          <h3 style="text-align:center ;">Completed Tasks</h3>
          <li v-for="(task, index) in completedTasks" :key="task">
            {{ task }}
          </li>
        </ul>
      </div>
    </div>
  </section>
  <!-- End your project here-->

  <!-- MDB -->
  <script type="text/javascript" src="js/mdb.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.18/vue.min.js"></script>

  <!-- Custom scripts -->
  <script>
    var vm = new Vue({
      el: '#to-do-list',
      data: function () {
        taskTxt: '';
        dateOfAddedTask: '';
        check: '';
        return {
          isEditing: false,
          empty: false,
          isChecked: false,
          'bg-green': this.isChecked,
          selectedFilter: 1, // default to "All"
          count: 0,//total number of dynamic added task.
          tasks: [],//this will carry the dynamic added task
          completedTasks: [],
          showCompleted: false,

        }

      },
      methods: {
        inputTask: function (event) {
          this.taskTxt = event.target.value;
          this.dateOfAddedTask = new Date();
        },
        add: function () {
          this.count++;
          this.text = "";
          const newTask = {
            id: `tasks[dynamic-field-${this.count}]`, // add unique id
            taskTxt: this.text,
            isCompleted: false,
            isEditing: false,
            editText: "",
            dueDate: "",
          };
          tasks[`dynamic-field-${this.count}`].push(newTask);
        },
        remove: function () {
          this.count--;
          return {
            'bg-green': '',
          }
          tasks[`dynamic-field-${this.count}`].pop();

        },
        edit(key) {
          this.isEditing[key] = true;
          this.editText[key] = this.tasks[key].taskTxt;
        },
        saveEditedTaskText(index) {
          this.tasks[key].taskTxt = this.editText[key];
          this.isEditing[key] = false;
        },
        completeTask(key) {
          if (this.isChecked[key]) {
            // Add the completed task to the completedTasks array
            this.completedTasks.push(this.tasks[`dynamic-field-${key}`]);

          } else {
            // Find the index of the completed task in the completedTasks array
            const index = this.completedTasks.indexOf(this.tasks[`dynamic-field-${key}`]);
            // If the task is found, remove it from the completedTasks array
            if (index !== -1) {
              this.completedTasks.splice(index, 1);
            }
          }
        },
        showCompletedTasks() {
          this.showingCompletedTasks = true;
        },


      },
      computed: {
        // CSS class for input and parent div
        checkCompleted() {
          return {
            'bg-green': this.isChecked,
          };
        },
        filteredTasks() {
          switch (this.selectedFilter) {
            case 2: // Completed
              return this.tasks.filter(task => task.isChecked);
            case 3: // Active
              return this.tasks.filter(task => !task.isChecked);
            case 4: // Has due date
              return this.tasks.filter(task => task.dueDate);
            default: // All
              return this.tasks;
          }
        },
      }
    })

  </script>
  <style>
    .bg-green {
      background-color: lightgreen !important;
    }
  </style>
</body>

</html>